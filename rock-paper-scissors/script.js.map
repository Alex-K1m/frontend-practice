{"version":3,"sources":["src/fm-challenges/advanced/rock-paper-scissors/script.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","$","animate","toggleDisplay","$overlay","$rulesBtn","$closeModalBtn","hideModal","event","stopPropagation","target","contains","then","addEventListener","./_utils","2","document","querySelector","bind","$$","querySelectorAll","$el","animation","Promise","resolve","removeAnimation","classList","remove","removeEventListener","add","delay","duration","setTimeout","toggle","genRandomNum","min","max","Math","floor","random","3","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","obj","value","configurable","writable","$playField","$result","$leftCol","$rightCol","$status","$score","$center","score","Number","localStorage","getItem","isGameInProgress","textContent","newOptionElement","className","$option","createElement","$spanWithIcon","concat","cloneNode","append","options","name","beats","map","opt","$element","toLowerCase","play","currentTarget","clickedOptName","getAttribute","playerPick","findIndex","housePick","_","isPlayerWon","includes","setItem","async","render","removeChild","lastElementChild","./_modal"],"mappings":"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","file":"script.js","sourcesContent":["require('./_modal');\nconst {\n  $,\n  $$,\n  animate,\n  delay,\n  toggleDisplay,\n  genRandomNum,\n} = require('./_utils');\n\nconst $playField = $('.playField');\nconst $result = $('.result');\nconst $leftCol = $('.result > .col:nth-child(1) > .box');\nconst $rightCol = $('.result > .col:nth-child(2) > .box');\nconst $status = $('.status');\nconst $score = $('.score > div:nth-child(2)');\nconst $center = $('.center');\n\nlet score = Number(localStorage.getItem('score')) || 0;\nlet isGameInProgress = false;\n\n$score.textContent = score;\n\nconst newOptionElement = className => {\n  const $option = document.createElement('div');\n  $option.classList.add('option', className);\n\n  const $spanWithIcon = $(`button.option.${className} > span`).cloneNode(true);\n  $option.append($spanWithIcon);\n\n  return $option;\n};\n\n// 'beats' contains indexes of the options\nconst options = [\n  { name: 'Scissors', beats: [1, 3] },\n  { name: 'Paper', beats: [2, 4] },\n  { name: 'Rock', beats: [3, 0] },\n  { name: 'Lizard', beats: [4, 1] },\n  { name: 'Spock', beats: [0, 2] },\n].map(opt => ({\n  ...opt,\n  $element: newOptionElement(opt.name.toLowerCase()),\n}));\n\nconst render = async (playerPick, housePick, isPlayerWon) => {\n  $leftCol.append(options[playerPick].$element);\n  await animate($playField, 'fadeOut');\n  toggleDisplay($playField);\n  await delay(300);\n\n  toggleDisplay($result);\n  await animate($result, 'fadeIn');\n  await delay(800);\n\n  $rightCol.append(options[housePick].$element);\n  await animate(options[housePick].$element, 'flip');\n  await delay(500);\n\n  (isPlayerWon ? $leftCol : $rightCol).classList.add('highlight');\n  await delay(1000);\n\n  $status.textContent = isPlayerWon ? 'You win' : 'You lose';\n  $result.classList.add('expanded');\n  await animate($center, 'expand');\n\n  animate($score, 'flip-scale');\n  await delay(300);\n  $score.textContent = score;\n};\n\nconst play = ({ currentTarget }) => {\n  if (isGameInProgress) return;\n  isGameInProgress = true;\n\n  const clickedOptName = currentTarget.getAttribute('aria-label');\n  const playerPick = options.findIndex(({ name }) => name === clickedOptName);\n\n  const random = genRandomNum(0, options.length - 1);\n  const housePick = options\n    .map((_, i) => i) // saving initial indexes\n    // filtering out the option already picked by a player\n    // & picking a random option from the rest\n    .filter((_, i) => i !== playerPick)[random];\n\n  const isPlayerWon = options[playerPick].beats.includes(housePick);\n\n  score += isPlayerWon ? 1 : -1;\n  localStorage.setItem('score', score);\n\n  render(playerPick, housePick, isPlayerWon);\n};\n\nconst newRound = async () => {\n  if (!isGameInProgress) return;\n  isGameInProgress = false;\n\n  await animate($result, 'fadeOut');\n  toggleDisplay($result);\n\n  toggleDisplay($playField);\n  animate($playField, 'fadeIn');\n\n  $('.highlight').classList.remove('highlight');\n\n  $result.classList.remove('expanded');\n\n  $leftCol.removeChild($leftCol.lastElementChild);\n  $rightCol.removeChild($rightCol.lastElementChild);\n\n  isGameInProgress = false;\n};\n\n$$('.playField .option').forEach($option => {\n  $option.addEventListener('click', play);\n});\n\n$('.repeat').addEventListener('click', newRound);\n"]}