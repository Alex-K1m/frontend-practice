{"version":3,"sources":["src/fm-challenges/advanced/rock-paper-scissors/script.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","$","animate","toggleDisplay","$overlay","$rulesBtn","$closeModalBtn","hideModal","event","stopPropagation","target","contains","then","addEventListener","./_utils","2","document","querySelector","bind","$$","querySelectorAll","$el","animation","Promise","resolve","removeAnimation","classList","remove","removeEventListener","add","delay","duration","setTimeout","toggle","genRandomNum","min","max","Math","floor","random","getSavedItem","key","localStorage","getItem","err","DOMException","message","includes","saveItem","value","setItem","3","$playField","$result","$leftCol","$rightCol","$status","$score","$center","savedScore","console","warn","score","Number","isGameInProgress","textContent","newOptionElement","className","$option","createElement","$spanWithIcon","concat","cloneNode","append","options","name","beats","map","opt","$element","toLowerCase","play","currentTarget","clickedOptName","getAttribute","playerPick","findIndex","housePick","_","filter","isPlayerWon","async","render","forEach","removeChild","lastElementChild","./_modal"],"mappings":"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","file":"script.js","sourcesContent":["require('./_modal');\nconst {\n  $,\n  $$,\n  animate,\n  delay,\n  toggleDisplay,\n  genRandomNum,\n  getSavedItem,\n  saveItem,\n} = require('./_utils');\n\nconst $playField = $('.playField');\nconst $result = $('.result');\nconst $leftCol = $('.result > .col:nth-child(1) > .box');\nconst $rightCol = $('.result > .col:nth-child(2) > .box');\nconst $status = $('.status');\nconst $score = $('.score > div:nth-child(2)');\nconst $center = $('.center');\n\nconst savedScore = getSavedItem('score');\nif (savedScore === null)\n  // eslint-disable-next-line no-console\n  console.warn(\n    \"The score won't be saved between sessions as third party cookies are disabled in your browser.\",\n  );\n\nlet score = Number(savedScore) || 0;\nlet isGameInProgress = false;\n\n$score.textContent = score;\n\nconst newOptionElement = className => {\n  const $option = document.createElement('div');\n  $option.classList.add('option', className);\n\n  const $spanWithIcon = $(`button.option.${className} > span`).cloneNode(true);\n  $option.append($spanWithIcon);\n\n  return $option;\n};\n\n// 'beats' contains indexes of the options\nconst options = [\n  { name: 'Scissors', beats: [1, 3] },\n  { name: 'Paper', beats: [2, 4] },\n  { name: 'Rock', beats: [3, 0] },\n  { name: 'Lizard', beats: [4, 1] },\n  { name: 'Spock', beats: [0, 2] },\n].map(opt => ({\n  ...opt,\n  $element: newOptionElement(opt.name.toLowerCase()),\n}));\n\nconst render = async (playerPick, housePick, isPlayerWon) => {\n  $leftCol.append(options[playerPick].$element);\n  await animate($playField, 'fadeOut');\n  toggleDisplay($playField);\n  await delay(300);\n\n  toggleDisplay($result);\n  await animate($result, 'fadeIn');\n  await delay(800);\n\n  $rightCol.append(options[housePick].$element);\n  await animate(options[housePick].$element, 'flip');\n  await delay(500);\n\n  (isPlayerWon ? $leftCol : $rightCol).classList.add('highlight');\n  await delay(1000);\n\n  $status.textContent = isPlayerWon ? 'You win' : 'You lose';\n  $result.classList.add('expanded');\n  await animate($center, 'expand');\n\n  animate($score, 'flip-scale');\n  await delay(300);\n  $score.textContent = score;\n};\n\nconst play = ({ currentTarget }) => {\n  if (isGameInProgress) return;\n  isGameInProgress = true;\n\n  const clickedOptName = currentTarget.getAttribute('aria-label');\n  const playerPick = options.findIndex(({ name }) => name === clickedOptName);\n\n  const random = genRandomNum(0, options.length - 1);\n  const housePick = options\n    .map((_, i) => i) // saving initial indexes\n    // filtering out the option already picked by a player\n    // & picking a random option from the rest\n    .filter((_, i) => i !== playerPick)[random];\n\n  const isPlayerWon = options[playerPick].beats.includes(housePick);\n\n  score += isPlayerWon ? 1 : -1;\n  saveItem('score', score);\n\n  render(playerPick, housePick, isPlayerWon);\n};\n\nconst newRound = async () => {\n  if (!isGameInProgress) return;\n  isGameInProgress = false;\n\n  await animate($result, 'fadeOut');\n  toggleDisplay($result);\n\n  toggleDisplay($playField);\n  animate($playField, 'fadeIn');\n\n  $('.highlight').classList.remove('highlight');\n\n  $result.classList.remove('expanded');\n\n  $leftCol.removeChild($leftCol.lastElementChild);\n  $rightCol.removeChild($rightCol.lastElementChild);\n\n  isGameInProgress = false;\n};\n\n$$('.playField .option').forEach($option => {\n  $option.addEventListener('click', play);\n});\n\n$('.repeat').addEventListener('click', newRound);\n"]}